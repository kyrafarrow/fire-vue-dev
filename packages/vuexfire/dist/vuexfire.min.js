!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.VuexFire=t():e.VuexFire=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t){function n(e){return"function"==typeof e.key?e.key():e.key}function i(e){return"function"==typeof e.ref?e=e.ref():"object"==typeof e.ref&&(e=e.ref),e}function o(e){return"[object Object]"===Object.prototype.toString.call(e)}function r(e){var t=e.val(),i=o(t)?t:{".value":t};return i[".key"]=n(e),i}function s(e){var t=e.val();return t[".key"]=n(e),t}function c(e,t){for(var n=0;n<e.length;n++)if(e[n][".key"]===t)return n;return-1}function f(e,t,n){var r=!1,s=null;if(o(n)&&n.hasOwnProperty("source")&&(r=n.asObject,s=n.cancelCallback,n=n.source),!o(n))throw new Error("VuexFire: invalid Firebase binding source.");if(!(t in e.$store.state))throw new Error('VuexFire: bind failed: "'+t+'" is not defined in the store state');var c=i(n);e.$firebaseRefs[t]=c,e._firebaseSources[t]=n,r?a(e,t,n,s):u(e,t,n,s)}function u(e,t,i,o){e.$store.state[t]=[];const f=i.on("child_added",function(n,i){const o=e.$store.state[t],r=i?c(o,i)+1:0;e.$store.dispatch($,t,r,s(n))},o),u=i.on("child_removed",function(i){const o=e.$store.state[t],r=c(o,n(i));e.$store.dispatch(v,t,r)},o),a=i.on("child_changed",function(i){const o=e.$store.state[t],s=c(o,n(i));e.$store.dispatch(_,t,s,r(i))},o),l=i.on("child_moved",function(i,o){const s=e.$store.state[t],f=c(s,n(i));console.log("moved");var u=o?c(s,o)+1:0;u+=f<u?-1:0,e.$store.dispatch(y,t,f,u,r(i))},o);e._firebaseListeners[t]={child_added:f,child_removed:u,child_changed:a,child_moved:l}}function a(e,t,n,i){const o=n.on("value",function(n){e.$store.dispatch(h,t,r(n))},i);e._firebaseListeners[t]={value:o}}function l(e,t){var n=e._firebaseSources&&e._firebaseSources[t];if(!n)throw new Error('VuexFire: unbind failed: "'+t+'" is not bound to a Firebase reference.');const i=e._firebaseListeners[t];for(var o in i)n.off(o,i[o]);e.$firebaseRefs[t]=null,e._firebaseSources[t]=null,e._firebaseListeners[t]=null}function d(e){e._mutations[h]=function(e,t,n){e[t]=n},e._mutations[_]=function(e,t,n,i){e[t].splice(n,1,i)},e._mutations[$]=function(e,t,n,i){e[t].splice(n,0,i)},e._mutations[v]=function(e,t,n){e[t].splice(n,1)},e._mutations[y]=function(e,t,n,i){const o=e[t];o.splice(i,0,o.splice(n,1)[0])}}function b(e){e.$firebaseRefs||(e.$firebaseRefs=Object.create(null),e._firebaseSources=Object.create(null),e._firebaseListeners=Object.create(null),d(e.$store))}function p(e){const t=e.prototype._init;e.prototype._init=function(e){e=e||{},e.init=e.init?[E].concat(e.init):E,t.call(this,e)},e.mixin(R);const n=e.config.optionMergeStrategies;n.firebase=n.methods,e.prototype.$bindAsObject=function(e,t,n){b(this),f(this,e,{source:t,asObject:!0,cancelCallback:n})},e.prototype.$bindAsArray=function(e,t,n){b(this),f(this,e,{source:t,cancelCallback:n})},e.prototype.$unbind=function(e){l(this,e)}}const h="VUEXFIRE_OBJECT_VALUE",_="VUEXFIRE_ARRAY_CHANGE",$="VUEXFIRE_ARRAY_ADD",v="VUEXFIRE_ARRAY_REMOVE",y="VUEXFIRE_ARRAY_MOVE",R={beforeDestroy:function(){if(this.$firebaseRefs){for(var e in this.$firebaseRefs)this.$firebaseRefs[e]&&this.$unbind(e);this.$firebaseRefs=null,this._firebaseSources=null,this._firebaseListeners=null}}},E=function(){const e=this.$options.firebase;if(e){b(this);for(var t in e)f(this,t,e[t])}};e.exports=p,"undefined"!=typeof window&&window.Vue&&p(window.Vue)}])});