/*!
 * vuexfire v0.3.0
 * (c) 2017 Eduardo San Martin Morote
 * Released under the MIT License.
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.VuexFire=e.VuexFire||{})}(this,function(e){"use strict";function n(e,n){for(var t=0;t<e.length;t++)if(e[t][".key"]===n)return t;return-1}function t(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(e){return"function"==typeof e.key?e.key():e.key}function i(e){return"function"==typeof e.ref?e=e.ref():"object"==typeof e.ref&&(e=e.ref),e}function o(e){var n=e.val(),i=t(n)?n:{".value":n};return i[".key"]=c(e),i}function r(e){}function u(e){var n=e.key,t=e.source,c=e.cancelCallback,i=e.listeners,r=e.commit,u=t.on("value",function(e){r(a,{key:n,record:o(e)})},c);i[n]={value:u}}function f(e){var t=e.key,i=e.source,r=e.cancelCallback,u=e.listeners,f=e.commit,d=e.state;f(l,{key:t});var a=i.on("child_added",function(e,c){var i=d[t],r=c?n(i,c)+1:0;f(y,{key:t,index:r,record:o(e)})},r),m=i.on("child_removed",function(e){var i=d[t],o=n(i,c(e));f(k,{key:t,index:o})},r),x=i.on("child_changed",function(e){var i=d[t],r=n(i,c(e));f(s,{key:t,index:r,record:o(e)})},r),p=i.on("child_moved",function(e,i){var r=d[t],u=n(r,c(e)),a=i?n(r,i)+1:0;a+=u<a?-1:0,f(v,{key:t,index:u,newIndex:a,record:o(e)})},r);u[t]={child_added:a,child_changed:x,child_removed:m,child_moved:p}}function d(e){function n(e,n,r){e in a&&t(e),a[e]=i(n),o[e]&&"length"in o[e]?f({key:e,source:n,cancelCallback:r,commit:c,state:o,listeners:d}):u({key:e,source:n,cancelCallback:r,commit:c,listeners:d})}function t(e){var n=a[e],t=d[e];for(var c in t)n.off(c,t[c])}var c=e.commit,o=e.state,r=e.context,d=Object.create(null),a=Object.create(null);return r&&r.commit&&(c=r.commit),{bind:n,unbind:t}}var a="vuexfire/OBJECT_VALUE",l="VUEXFIRE_ARRAY_INITIALIZE",y="vuexfire/ARRAY_ADD",s="vuexfire/ARRAY_CHANGE",v="vuexfire/ARRAY_MOVE",k="vuexfire/ARRAY_REMOVE",m={};m[a]=function(e,n){e[n.key]=n.record},m[l]=function(e,n){e[n.key]=[]},m[y]=function(e,n){e[n.key].splice(n.index,0,n.record)},m[s]=function(e,n){e[n.key].splice(n.index,1,n.record)},m[v]=function(e,n){var t=e[n.key];t.splice(n.newIndex,0,t.splice(n.index,1)[0])},m[k]=function(e,n){e[n.key].splice(n.index,1)},e.default=r,e.generateBind=d,e.mutations=m,Object.defineProperty(e,"__esModule",{value:!0})});