!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.VuexFire=t():e.VuexFire=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t){function n(e){return"function"==typeof e.key?e.key():e.key}function i(e){return"function"==typeof e.ref?e=e.ref():"object"==typeof e.ref&&(e=e.ref),e}function o(e){return"[object Object]"===Object.prototype.toString.call(e)}function r(e){var t=e.val(),i=o(t)?t:{".value":t};return i[".key"]=n(e),i}function s(e,t){for(var n=0;n<e.length;n++)if(e[n][".key"]===t)return n;return-1}function c(e,t,n){var r=!1,s=null;if(o(n)&&n.hasOwnProperty("source")&&(r=n.asObject,s=n.cancelCallback,n=n.source),!o(n))throw new Error("VuexFire: invalid Firebase binding source.");if(!(t in e.$store.state))throw new Error('VuexFire: bind failed: "'+t+'" is not defined in the store state');var c=i(n);e.$firebaseRefs[t]=c,e._firebaseSources[t]=n,r?a(e,t,n,s):f(e,t,n,s)}function f(e,t,i,o){e.$store.state[t]=[];const c=i.on("child_added",function(n,i){const o=e.$store.state[t],c=i?s(o,i)+1:0;e.$store.commit(y,{key:t,index:c,record:r(n)})},o),f=i.on("child_removed",function(i){const o=e.$store.state[t],r=s(o,n(i));e.$store.commit(h,{key:t,index:r})},o),a=i.on("child_changed",function(i){const o=e.$store.state[t],c=s(o,n(i));e.$store.commit(m,{key:t,index:c,record:r(i)})},o),u=i.on("child_moved",function(i,o){const c=e.$store.state[t],f=s(c,n(i));var a=o?s(c,o)+1:0;a+=f<a?-1:0,e.$store.commit(x,{key:t,index:f,newIndex:a,record:r(i)})},o);e._firebaseListeners[t]={child_added:c,child_removed:f,child_changed:a,child_moved:u}}function a(e,t,n,i){const o=n.on("value",function(n){e.$store.commit(p,{key:t,record:r(n)})},i);e._firebaseListeners[t]={value:o}}function u(e,t){var n=e._firebaseSources&&e._firebaseSources[t];if(!n)throw new Error('VuexFire: unbind failed: "'+t+'" is not bound to a Firebase reference.');e.$store.commit(p,{key:t,record:null});const i=e._firebaseListeners[t];for(var o in i)n.off(o,i[o]);e.$firebaseRefs[t]=null,e._firebaseSources[t]=null,e._firebaseListeners[t]=null}function d(e){if(!e.$firebaseRefs){if(e.$firebaseRefs=Object.create(null),e._firebaseSources=Object.create(null),e._firebaseListeners=Object.create(null),!e.$store)throw new Error("VuexFire: missing Vuex. Install Vuex before VuexFire");e.$store.commit||(b(e.$store),e.$store.commit=e.$store.dispatch)}}function l(e){const t=Number(e.version.split(".")[0]);if(t>=2){const n=e.config._lifecycleHooks.indexOf("init")>-1;e.mixin(n?{init:v}:{beforeCreate:v})}else{const i=e.prototype._init;e.prototype._init=function(e){e=e||{},e.init=e.init?[v].concat(e.init):v,i.call(this,e)}}e.mixin($);const o=e.config.optionMergeStrategies;o.firebase=o.methods,e.prototype.$bindAsObject=function(e,t,n){d(this),c(this,e,{source:t,asObject:!0,cancelCallback:n})},e.prototype.$bindAsArray=function(e,t,n){d(this),c(this,e,{source:t,cancelCallback:n})},e.prototype.$unbind=function(e){u(this,e)}}function b(e){for(var t in l.mutations)e._mutations[t]=l.mutations[t]}const p="VUEXFIRE/objectValue",m="VUEXFIRE/arrayChange",y="VUEXFIRE/arrayAdd",h="VUEXFIRE/arrayRemove",x="VUEXFIRE/arrayMove",$={beforeDestroy:function(){if(this.$firebaseRefs){for(var e in this.$firebaseRefs)this.$firebaseRefs[e]&&this.$unbind(e);this.$firebaseRefs=null,this._firebaseSources=null,this._firebaseListeners=null}}},v=function(){const e=this.$options.firebase;if(e){d(this);for(var t in e)c(this,t,e[t])}};l.mutations={},l.mutations[p]=function(e,t){e[t.key]=t.record},l.mutations[m]=function(e,t){e[t.key].splice(t.index,1,t.record)},l.mutations[y]=function(e,t){e[t.key].splice(t.index,0,t.record)},l.mutations[h]=function(e,t){e[t.key].splice(t.index,1)},l.mutations[x]=function(e,t){const n=e[t.key];n.splice(t.newIndex,0,n.splice(t.index,1)[0])},e.exports=l,"undefined"!=typeof window&&window.Vue&&l(window.Vue)}])});